(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{69:function(e,a,t){e.exports=t(84)},84:function(e,a,t){"use strict";t.r(a);var n=t(0),l=t.n(n),r=t(61),c=t.n(r),m=t(10),o=t(6),u=t(20),i=t(62);const s=Object(u.d)({baseUrl:""}),E=Object(i.a)({baseQuery:s,tagTypes:["Product","Order","user"],endpoints:e=>({})}),d=e=>(Math.round(100*e)/100).toFixed(2),g=e=>{e.itemsPrice=d(e.cartItems.reduce((e,a)=>e+a.price*a.qty,0)),e.shippingPrice=d(e.itemsPrice>100?0:10),e.taxPrice=d(Number((.15*e.itemsPrice).toFixed(2))),e.totalPrice=(Number(e.itemsPrice)+Number(e.shippingPrice)+Number(e.taxPrice)).toFixed(2),localStorage.setItem("cart",JSON.stringify(e))},p=localStorage.getItem("cart")?JSON.parse(localStorage.getItem("cart")):{cartItems:[]},v=Object(o.e)({name:"cart",initialState:p,reducers:{addToCart:(e,a)=>{const t=a.payload,n=e.cartItems.find(e=>e._id===t._id);return e.cartItems=n?e.cartItems.map(e=>e._id===n._id?t:e):[...e.cartItems,t],g(e)},removeFromCart:(e,a)=>(e.cartItems=e.cartItems.filter(e=>e._id!==a.payload),g(e))}}),{addToCart:b,removeFromCart:y}=v.actions;var h=v.reducer;const I={userInfo:localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")):null},f=Object(o.e)({name:"auth",initialState:I,reducers:{setCredentials:(e,a)=>{e.userInfo=a.payload,localStorage.setItem("userInfo",JSON.stringify(a.payload))},logout:(e,a)=>{e.userInfo=null,localStorage.removeItem("userInfo")}}}),{setCredentials:k,logout:S}=f.actions;var O=f.reducer;var C=Object(o.b)({reducer:{[E.reducerPath]:E.reducer,cart:h,auth:O},middleware:e=>e().concat(E.middleware),devTools:!0}),P=(t(77),t(89)),j=t(14),w=t(5),L=t(96),N=t(100),x=t(90),F=t(95),q=t(11),T=t(47);const $=E.injectEndpoints({endpoints:e=>({login:e.mutation({query:e=>({url:"/api/users/auth",method:"POST",body:e})}),logout:e.mutation({query:e=>({url:"/api/users/logout",method:"POST"})})})}),{useLoginMutation:_,useLogoutMutation:B}=$;var Q=()=>{const{cartItems:e}=Object(m.f)(e=>e.cart),{userInfo:a}=Object(m.f)(e=>e.auth),t=Object(m.e)(),n=Object(w.Q)(),[r]=B();return l.a.createElement("header",null,l.a.createElement(L.a,{bg:"dark",variant:"dark",expand:"md",collapseOnSelect:!0},l.a.createElement(P.a,null,l.a.createElement(T.LinkContainer,{to:"/"},l.a.createElement(L.a.Brand,null," Proshop")),l.a.createElement(L.a.Toggle,{"area-controls":"basic-navbar-nav"}),l.a.createElement(L.a.Collapse,{id:"basic-navbar-nav"},l.a.createElement(N.a,{className:"ms-auto"},l.a.createElement(T.LinkContainer,{to:"/cart"},l.a.createElement(N.a.Link,{href:"/cart"},l.a.createElement(q.b,null),"Cart",e.length>0&&l.a.createElement(x.a,{pill:!0,bg:"success",style:{marginLeft:"5px"}},e.reduce((e,a)=>e+a.qty,0)))),a?l.a.createElement(F.a,{title:a.name,id:"username"},l.a.createElement(T.LinkContainer,{to:"/profile"},l.a.createElement(F.a.Item,null,"Profile")),l.a.createElement(F.a.Item,{onClick:async()=>{console.log("logout");try{await r().unwrap(),t(S()),n("/login")}catch(e){console.log("logout error",e)}}},"Logout")):l.a.createElement(T.LinkContainer,{to:"/login"},l.a.createElement(N.a.Link,{href:"/login"},l.a.createElement(q.b,null),"Sign In")))))))},D=t(91),G=t(65);var J=()=>{const e=(new Date).getFullYear();return l.a.createElement("footer",null,l.a.createElement(P.a,null,l.a.createElement(D.a,null,l.a.createElement(G.a,{className:"text-center py-3"},l.a.createElement("p",null," Proshop \xa9 ",e)))))},R=t(98);var A=e=>{let{value:a,text:t}=e;return l.a.createElement("div",{className:"rating"},l.a.createElement("span",null,a>=1?l.a.createElement(q.c,null):a>=.5?l.a.createElement(q.d,null):l.a.createElement(q.a,null)),l.a.createElement("span",null,a>=2?l.a.createElement(q.c,null):a>=1.5?l.a.createElement(q.d,null):l.a.createElement(q.a,null)),l.a.createElement("span",null,a>=3?l.a.createElement(q.c,null):a>=2.5?l.a.createElement(q.d,null):l.a.createElement(q.a,null)),l.a.createElement("span",null,a>=4?l.a.createElement(q.c,null):a>=3.5?l.a.createElement(q.d,null):l.a.createElement(q.a,null)),l.a.createElement("span",null,a>=5?l.a.createElement(q.c,null):a>=4.5?l.a.createElement(q.d,null):l.a.createElement(q.a,null)),l.a.createElement("span",{className:"rating-text"},t&&t))};var M=e=>{let{product:a}=e;return l.a.createElement(R.a,{className:"my-3 p-3 rounded"},l.a.createElement(j.Link,{href:`/product/${a._id}`},l.a.createElement(R.a.Img,{src:a.image,variant:"top"})),l.a.createElement(R.a.Body,null,l.a.createElement(j.Link,{to:`/product/${a._id}`},l.a.createElement(R.a.Title,{as:"div"},l.a.createElement("strong",null,a.name))),l.a.createElement(R.a.Text,{as:"h3"},l.a.createElement(A,{value:a.rating,text:`${a.numReviews} reviews`}),"$",a.rating)))},U=t(92);var Y=()=>l.a.createElement(U.a,{animation:"border",role:"status",style:{width:"100px",height:"100px",margin:"auto",display:"block"}}),V=t(99);const z=e=>{let{variant:a,children:t}=e;return l.a.createElement(V.a,{variant:a},t)};z.defaultProps={variant:"info"};var H=z;const K=E.injectEndpoints({endpoints:e=>({getProducts:e.query({query:()=>({url:"/api/products"}),keepUnusedDataFor:5}),getProductDetails:e.query({query:e=>({url:`/api/products/${e}`}),keepUnusedDataFor:5})})}),{useGetProductsQuery:W,useGetProductDetailsQuery:X}=K;var Z=()=>{var e;const{data:a,isLoading:t,error:n}=W();return l.a.createElement(l.a.Fragment,null,t?l.a.createElement(Y,null):n?l.a.createElement(H,{variant:"danger"},(null===n||void 0===n?void 0:null===(e=n.data)||void 0===e?void 0:e.message)||n.error):l.a.createElement(l.a.Fragment,null,l.a.createElement("h1",null,"Latest Products"),l.a.createElement(D.a,null,a.map(e=>l.a.createElement(G.a,{key:e._id,sm:12,md:6,lg:4,xl:3},l.a.createElement(M,{product:e}))))))},ee=t(93),ae=t(94),te=t(66),ne=t(97),le=t(64);var re=()=>{var e;const{id:a}=Object(w.V)(),t=Object(m.e)(),r=Object(w.Q)(),[c,o]=Object(n.useState)(1),{data:u,isLoading:i,error:s}=X(a);return l.a.createElement(l.a.Fragment,null,l.a.createElement(j.Link,{className:"btn btn-light my-3",to:"/"},"Go Back"),i?l.a.createElement(Y,null):s?l.a.createElement(H,{variant:"danger"},(null===s||void 0===s?void 0:null===(e=s.data)||void 0===e?void 0:e.message)||s.error):l.a.createElement(l.a.Fragment,null,l.a.createElement(D.a,null,l.a.createElement(G.a,{md:5},l.a.createElement(ee.a,{src:u.image,alt:u.name,fluid:!0})),l.a.createElement(G.a,{md:4},l.a.createElement(ae.a,{variant:"flush"},l.a.createElement(te.a,null,l.a.createElement("h3",null,u.name)),l.a.createElement(te.a,null,l.a.createElement(A,{value:u.rating,text:`${u.numReviews} reviews`})))),l.a.createElement(G.a,{md:3},l.a.createElement(R.a,null,l.a.createElement(ae.a,{variant:"flush"},l.a.createElement(te.a,null,l.a.createElement(D.a,null,l.a.createElement(G.a,null,"Price:"),l.a.createElement(G.a,null,l.a.createElement("strong",null,"$",u.price)))),l.a.createElement(te.a,null,l.a.createElement(D.a,null,l.a.createElement(G.a,null,"Status:"),l.a.createElement(G.a,null,l.a.createElement("strong",null,"$",u.countInStock>0?"In Stock":"Out of Stock")))),u.countInStock>0&&l.a.createElement(ae.a.Item,null,l.a.createElement(D.a,null,l.a.createElement(G.a,null,"Qty"),l.a.createElement(G.a,null,l.a.createElement(ne.a.Control,{as:"select",value:c,onChange:e=>o(Number(e.target.value))},[...Array(u.countInStock).keys()].map(e=>l.a.createElement("option",{key:e+1,value:e+1},e+1)))))),l.a.createElement(te.a,null,l.a.createElement(le.a,{onClick:()=>{t(b({...u,qty:c})),r("/cart")},className:"btn-block",type:"button",disabled:0===u.countInStock},"Add To Cart"))))))))};var ce=()=>{const e=Object(w.Q)(),a=Object(m.e)(),t=Object(m.f)(e=>e.cart),{cartItems:n}=t;return l.a.createElement(D.a,null,l.a.createElement(G.a,{md:8},l.a.createElement("h1",{style:{marginBottom:"20px"}},"Shopping Cart"),0===n.length?l.a.createElement(H,null,"Your cart is empty ",l.a.createElement(j.Link,{to:"/"},"Go Back")):l.a.createElement(ae.a,{variant:"flush"},n.map(e=>l.a.createElement(ae.a.Item,{key:e.product},l.a.createElement(D.a,null,l.a.createElement(G.a,{md:2},l.a.createElement(ee.a,{src:e.image,alt:e.name,fluid:!0,rounded:!0})),l.a.createElement(G.a,{md:3},l.a.createElement(j.Link,{to:`/product/${e.product}`},e.name)),l.a.createElement(G.a,{md:2},"$",e.price),l.a.createElement(G.a,{md:2},l.a.createElement(ne.a.Control,{as:"select",value:e.qty,onChange:t=>(async(e,t)=>{a(b({...e,qty:t}))})(e,Number(t.target.value))},[...Array(e.countInStock).keys()].map(e=>l.a.createElement("option",{key:e+1,value:e+1},e+1)))),l.a.createElement(G.a,{md:2},l.a.createElement(le.a,{type:"button",variant:"light",onClick:()=>(async e=>{a(y(e))})(e._id)},l.a.createElement(q.e,null)))))))),l.a.createElement(G.a,{md:4},l.a.createElement(R.a,null,l.a.createElement(ae.a,{variant:"flush"},l.a.createElement(ae.a.Item,null,l.a.createElement("h2",null,"Subtotal (",n.reduce((e,a)=>e+a.qty,0),") items"),"$",n.reduce((e,a)=>e+a.qty*a.price,0).toFixed(2)),l.a.createElement(ae.a.Item,null,l.a.createElement(le.a,{type:"button",className:"btn-block",disabled:0===n.length,onClick:()=>{e("/login?redirect=/shipping")}},"Proceed To Checkout"))))))};var me=e=>{let{children:a}=e;return l.a.createElement(P.a,null,l.a.createElement(D.a,{className:"justify-content-md-center"},l.a.createElement(G.a,{xs:12,md:6},a)))};var oe=e=>{let{location:a,history:t}=e;const[r,c]=Object(n.useState)(""),[o,u]=Object(n.useState)(""),i=Object(m.e)(),s=Object(w.Q)(),[E,{isLoading:d}]=_(),{userInfo:g}=Object(m.f)(e=>e.auth);console.log("userInfo",g);const{search:p}=Object(w.N)(),v=new URLSearchParams(p).get("redirect")||"/";Object(n.useEffect)(()=>{g&&(console.log("navigating"),s(v))},[s,g,v]);return l.a.createElement(me,null,l.a.createElement("h1",null,"Sign In"),l.a.createElement(ne.a,{onSubmit:async e=>{e.preventDefault(),console.log("submit");try{const e=await E({email:r,password:o}).unwrap();i(k({...e})),s(v)}catch(a){alert("Login error")}}},l.a.createElement(ne.a.Group,{controlId:"email"},l.a.createElement(ne.a.Label,null,"Email Address"),l.a.createElement(ne.a.Control,{type:"email",placeholder:"Enter email",value:r,onChange:e=>c(e.target.value)})),l.a.createElement(ne.a.Group,{controlId:"password"},l.a.createElement(ne.a.Label,null,"Password"),l.a.createElement(ne.a.Control,{type:"password",placeholder:"Enter password",value:o,onChange:e=>u(e.target.value)})),l.a.createElement(le.a,{type:"submit",variant:"primary"},"Sign In"),d&&l.a.createElement(Y,null)),l.a.createElement(D.a,{className:"py-3"},l.a.createElement(G.a,null,"New Customer?",l.a.createElement(j.Link,{to:v?`/register?redirect=${v}`:"/register"},"Register"))))};var ue=()=>l.a.createElement(l.a.Fragment,null,l.a.createElement(j.BrowserRouter,null,l.a.createElement(Q,null),l.a.createElement("main",{className:"py-3"},l.a.createElement(P.a,null,l.a.createElement(w.i,null,l.a.createElement(w.g,{index:!0,path:"/",element:l.a.createElement(Z,null)}),l.a.createElement(w.g,{path:"/product/:id",element:l.a.createElement(re,null)}),l.a.createElement(w.g,{path:"/cart",element:l.a.createElement(ce,null)}),l.a.createElement(w.g,{path:"/login",element:l.a.createElement(oe,null)})),l.a.createElement(w.f,null))),l.a.createElement(J,null)));var ie=e=>{e&&e instanceof Function&&t.e(3).then(t.bind(null,101)).then(a=>{let{getCLS:t,getFID:n,getFCP:l,getLCP:r,getTTFB:c}=a;t(e),n(e),l(e),r(e),c(e)})};c.a.createRoot(document.getElementById("root")).render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(m.a,{store:C},l.a.createElement(ue,null)))),ie()}},[[69,1,2]]]);
//# sourceMappingURL=main.e16916ce.chunk.js.map